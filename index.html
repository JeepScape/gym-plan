<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Gym Plan · Safe Mode</title>
<meta name="theme-color" content="#0b0c0f">
<link rel="manifest" href="manifest.webmanifest">
<style>
  body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Arial,sans-serif;margin:0;background:#0b0c0f;color:#eef0f3;display:flex;align-items:center;justify-content:center;min-height:100vh;padding:24px}
  .card{max-width:680px;background:#151924;border:1px solid #1f2330;border-radius:14px;padding:18px}
  h1{margin:0 0 8px 0;font-size:22px}
  p{color:#aab2c0;line-height:1.5}
  code{background:#0b0c0f;padding:2px 6px;border-radius:6px;border:1px solid #1f2330;color:#cde1ff}
</style>
</head>
<body>
<div class="card">
  <h1>Safe Mode</h1>
  <p>Your previous service worker cache likely caused a blank page. This Safe Mode build clears old caches and unregisters the worker.</p>
  <ol>
    <li>Reload once after it says “Cleanup done”.</li>
    <li>Then you can upload the full app again.</li>
  </ol>
  <p id="status">Cleaning up…</p>
</div>
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('./service-worker.js').then(async reg => {
    // Wait a little for cleanup; then show status.
    setTimeout(()=>document.getElementById('status').textContent='Cleanup done. Reload this page once.', 1500);
  }).catch(e=>{
    document.getElementById('status').textContent='SW register failed, but page is safe.';
  });
} else {
  document.getElementById('status').textContent='No service worker support; page is safe.';
}
</script>
</body>
</html>
